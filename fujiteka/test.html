<!DOCTYPE html>
<html>
<link rel="stylesheet" href="../css/test.css">
<link rel="stylesheet" href="../css/voxfont.css">
<head>
  <title>Аудиоплеер</title>
</head>
<body>
    <div style="min-height: 8px"></div>
    <div class="vox white" style="font-size: 24pt">
        <div class="menu-row">
            <div class="standart-block menu-block mb-left">Go back</div>            
            <div class="standart-block menu-block mb-right">Fujiy4net Audio Player</div>
            <!-- <div class="standart-block menu-block mb-right">Premium</div> -->
        </div>
    </div>
    <div style="min-height: 8px"></div>
    <div class="standart-block">
        <div class="content-row" id="c-r">
            <div class="content-player" id="c-p">
                <div class="player vox white">
                    <div style="font-size: 24pt">
                        <span id="track-name">Select track</span>
                        <span id="track-duration">0:00</span>
                    </div>
                    <div style="min-height: 30pt"></div>                    
                    <audio id="audio" src="audio/Fuj777 - KASKADE.wav"></audio>
                    <div class="full-slider-area" >  
                        <div class="left-slider-area" id="track"></div>
                        <input type="range" id="seek" min="0" max="100" value="0">
                    </div>
                    <div style="min-height: 16pt"></div>  
                    
                    <div id="debug-text" style="font-size: 0px;">text</div>
                    <div class="main-contols">
                        <div class="main-controls-left">
                            <div id="outer">
                                <div id="inner">                              
                                    <span id="play">Play</span>
                                    <span id="pause">Pause</span>
                                </div>
                            </div>       
                        </div>
                        <div class="main-controls-right">
                            <div class="controls">                       
                                <haf class="trl">
                                    <div class="in-trl">
                                        <div style="font-size: 18pt">
                                            <span id="volume-text">Volume</span>
                                            <span id="volume-value">50%</span>
                                        </div>
                                        <div style="min-height: 24pt"></div>
                                        <div class="full-slider-area" >  
                                            <div class="left-slider-area" style="width: 50%;" id="volume-slider"></div>
                                            <input type="range" id="volume" min="0" max="100" value="50">
                                        </div>
                                    </div>
                                </haf>
                                <haf class="trl">
                                    <div class="in-trl">
                                        <div style="font-size: 18pt">
                                            <span id="speed-text">Speed</span>
                                            <span id="speed-value">1x</span>
                                        </div>
                                        <div style="min-height: 24pt"></div>
                                        <div class="full-slider-area" >  
                                            <div class="left-slider-area" style="width: 47.36%;" id="speed-slider"></div>
                                            <input type="range" id="speed" min="0.1" max="2" step="0.1" value="1">
                                        </div>   
                                    </div>                         
                                </haf>
                            </div>  
                        </div> 
                    </div>                 
                </div>
            </div>
            <div class="content-list" id="c-l">
                <div class="vox white pic" style="font-size: 24pt">
                    <div>album</div>
                    <div>image</div><br>
                </div>
            </div>
        </div>
    </div>
    <div style="min-height: 8px"></div>
    <div class="standart-block">
        <div class="vox" style="font-size: 24pt">
            <div id="fileList"></div>
        </div>
    </div>
    <!-- <div class="standart-block">
        <div class="vox white" style="font-size: 24pt">
            <ul id="fileList"></ul>
            <input type="text" id="fileInfo" readonly>
        </div>
    </div> -->

  <script>
    const audio = document.getElementById("audio");
    const playButton = document.getElementById("play");
    const pauseButton = document.getElementById("pause");
    const volumeControl = document.getElementById("volume");
    const speedControl = document.getElementById("speed");
    const seekControl = document.getElementById("seek");

    const leftSliderArea = document.getElementById("track");
    const volSlider = document.getElementById("volume-slider");
    const spdSlider = document.getElementById("speed-slider");
    const dText = document.getElementById("debug-text");
    const durationText = document.getElementById("track-duration");
    const spdText = document.getElementById("speed-value");
    const volText = document.getElementById("volume-value");

    playButton.addEventListener("click", function() {
        var text = document.getElementById('track-name')
        if (text.textContent == 'Select track') {
            document.getElementById('track-name').innerHTML = 'Fuj777, KASKADE';
            audio.src = 'audio/Fuj777 - KASKADE.wav';
        }
      audio.play();
    });

    pauseButton.addEventListener("click", function() {
      audio.pause();
    });

    volumeControl.addEventListener("input", function() {
      audio.volume = volumeControl.value / 100;
      volSlider.style.width = volumeControl.value + '%'
      volText.innerHTML = volumeControl.value + '%'
    });

    speedControl.addEventListener("input", function() {
      audio.playbackRate = speedControl.value;   
      spdText.innerHTML = audio.playbackRate + 'x'
      console.log(speedControl.value, audio.playbackRate);  
      spdSlider.style.width = ((speedControl.value - 0.1) / (2.0 - 0.1) * 100) + '%' 
    });

    audio.addEventListener("timeupdate", function() {      
      audio.playbackRate = speedControl.value;            
      seekControl.value = (audio.currentTime / audio.duration) * 100;
      leftSliderArea.style.width = seekControl.value + '%'      
      volSlider.style.width = volumeControl.value + '%'
      if (isNaN(audio.duration)) {
        seekControl.value = 0;
        leftSliderArea.style.width = '0%'
        }
      else{
        if (audio.currentTime > 599){
            sec = new Date(Math.round(audio.currentTime) * 1000).toISOString().slice(14, 19);
        }
        else{
            sec = new Date(Math.round(audio.currentTime) * 1000).toISOString().slice(15, 19);
        }
        durationText.innerHTML = sec;
        }
    });

    seekControl.addEventListener("input", function() {
      audio.currentTime = (seekControl.value * audio.duration) / 100;
      dText.innerHTML = seekControl.value + '%'
      leftSliderArea.style.width = seekControl.value + '%'
    });
    
    function displayAudioFiles() {
      var fileList = document.getElementById('fileList');
      var audioFiles = ['audio/Fuj777 - KASKADE.wav',
                        'audio/Fuj777 - 2024.mp3',
                        'audio/Fuj777 - classic.mp3',
                        'audio/Fuj777 - 2014.mp3',
                        'audio/Fuj777 - svc1.mp3',
                        'audio/Fuj778 - 2922.mp3']; //можно взять список аудио файлов из своей папки
      audioFiles.forEach(function(file) {
        var fileName = file.split('/').pop().replace(/\.[^/.]+$/, '');
        var audioName = fileName
        fileName = fileName.split('-');
        var index = 0;
        var listItem = document.createElement('div'); 
        listItem.classList.add('list-row')
        var splitItem = document.createElement('div'); 
        splitItem.classList.add('splitter-row')
        var childItem;
        var artistName;
        var songName;
        fileName.forEach(function(element) {
            index++
            if (index==1){
                childItem = document.createElement('span');
                childItem.classList.add('artist-meta')        
                childItem.textContent = element;
                artistName = element
            }
            else{
                childItem = document.createElement('span');
                childItem.classList.add('song-name-meta')         
                childItem.textContent = element;
                songName = element
            }            
           
            listItem.appendChild(childItem);
        });
        listItem.addEventListener('click', function() {
                document.getElementById('track-name').innerHTML = songName + ' - ' + artistName;
                document.getElementById('audio').src = file;
                audio.play();          
            });
        fileList.appendChild(listItem);
        fileList.appendChild(splitItem);
        
        });
    }
    function zero_first_format(value)
    {
        if (value < 10)
        {
            value='0'+value;
        }
        return value;
    }
    
    displayAudioFiles();


    // function textAlignFont() { 
    //     divElement = document.getElementById("outer");

    //     height = divElement.offsetHeight;

    //     var el = document.getElementById('outer');
    //     var style = window.getComputedStyle(el, null).getPropertyValue('font-size');
    //     var fontSize = parseFloat(style);
                 
    //     while (height>70){
    //         fontSize = fontSize - 1
    //         el.style.fontSize = fontSize + 'px';
    //         divElement = document.getElementById("outer");
    //         height = divElement.offsetHeight;
    //     }
    // }
    // textAlignFont()
    // window.onresize = textAlignFont;

    // function picAlignWidth() { 
    //     pic = document.getElementById("c-l");
    //     plr = document.getElementById("c-p");
    //     mainW = document.getElementById("c-r")

    //     console.log(getComputedStyle(mainW).width,   getComputedStyle(mainW).height)   
    //     h = parseFloat(getComputedStyle(mainW).height)
    //     w = parseFloat(getComputedStyle(mainW).width)
    //     pic.style.width = (h*100/w) + '%';
    //     plr.style.width = 100 - pic.style.width
    //     console.log(pic.style.width)
    //     // var el = document.getElementById('outer');
    //     // var style = window.getComputedStyle(el, null).getPropertyValue('font-size');
    //     // var fontSize = parseFloat(style);
                
    //     // console.log(fontSize)    
    //     // while (height>70){
    //     //     fontSize = fontSize - 1
    //     //     el.style.fontSize = fontSize + 'px';
    //     //     divElement = document.getElementById("outer");
    //     //     height = divElement.offsetHeight;
    //     // }
    // }
    // picAlignWidth()
    // window.onresize = picAlignWidth;
  </script>
</body>
</html>
